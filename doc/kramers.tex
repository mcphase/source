\newpage
\section{Module {\prg kramer}  - a Kramers Ground State Doublet Single Ion Module}\label{kramers}

The crystal field ground state of a magnetic ion often can be
approximated by a doublet. In this description the crystal field
anisotropy enters by defining the saturation moment of this doublet
in $a$,$b$ and $c$ direction: denoting the two states of the doublet
by $|\pm>$ the non vanishing matrix elements of the angular momentum
operator can be abbreviated by 

\begin{eqnarray}
<\pm|{\hat \mbf J}_a|\mp>=A & A^{\star}=A & A\mbox{... saturation moment in $a$ direction}\nonumber\\
<\pm|{\hat \mbf J}_b|\pm>=\pm B & B^{\star}=B & B\mbox{... saturation moment in $b$ direction}\\
<\pm|{\hat \mbf J}_c|\mp>=C & C^{\star}=-C & C\mbox{... saturation moment in $c$ direction}\nonumber\\
\end{eqnarray}


then the single ion Hamiltonian $H=H_{cf}- g_J \mu_b {\mbf H}{\mbf J}$
can be written as

\begin{equation}\label{hamkramer}
\hat H=g_J \mu_B 
\left (
\begin{array}{cc}
B H_b & -A H_a- C H_c\\
-A H_a +C H_c &  -B H_b
\end{array}
\right)=
\left (
\begin{array}{cc}
\alpha & \beta\\
\beta^{\star} & -\alpha
\end{array}
\right)
\end{equation}

This Hamilton may be diagonalised yielding the 2 eigenvalues
$\lambda_{\pm}$,$\Delta=\lambda_+ - \lambda_-$:

\begin{equation}
\lambda_{\pm}=\pm \sqrt{\alpha^2+\beta^{\star}\beta}
\end{equation}

and the eigenvectors

\begin{equation}
|\lambda_{\pm}>=\frac{-\beta|+>+(\alpha-\lambda_{\pm})|->}
{\sqrt{|\alpha-\lambda_{\pm}|^2+\beta^{\star}\beta}}
\end{equation}

using Boltzmann statistics ($Z=\exp(-\Delta/2kT)+\exp(\Delta/2kT)$) the expectation values of the magnetic
moment can be calculated as

\begin{equation}
<{\hat \mbf M}>=\sum_{\pm}<\lambda_{\pm}|g_J{\hat \mbf J}|\lambda_{\pm}>
\frac{\exp(-\lambda_{\pm}/kT)}{Z}
\end{equation}

with 

\begin{equation}
<\lambda_{\pm}|\hat J_a|\lambda_{\pm}>=
\frac{-2A \Re[\beta^{\star}(\alpha-\lambda_{\pm})]}
{|\alpha-\lambda_{\pm}|^2+\beta^{\star}\beta}
\end{equation}

\begin{equation}
<\lambda_{\pm}|\hat J_b|\lambda_{\pm}>=
\frac{-B \beta^{\star}\beta+B|\alpha-\lambda_{\pm}|^2}
{|\alpha-\lambda_{\pm}|^2+\beta^{\star}\beta}
\end{equation}

\begin{equation}
<\lambda_{\pm}|\hat J_c|\lambda_{\pm}>=
\frac{2 \Re(\beta C)(\alpha-\lambda_{\pm})}
{|\alpha-\lambda_{\pm}|^2+\beta^{\star}\beta}
\end{equation}

The magnetic energy $U$ can be calculated

\begin{equation}
U=\sum_{\pm}\lambda_{\pm}\frac{\exp(-\lambda_{\pm}/kT)}{Z}
\end{equation}

For the calculation of the magnetic excitations the program {\tt mcdisp}
needs also a function which calculates the transition matrix elements

\begin{equation}
M_{\alpha\beta}=<\lambda_-|\hat J_{\alpha}|\lambda_+>
<\lambda_+|\hat J_{\beta}|\lambda_-> \tanh(\Delta/2kT)
\end{equation}

using the expressions

\begin{equation}
<\lambda_-|\hat J_a|\lambda_+>=
\frac{-2A (\alpha\Re(\beta)+i\lambda_+ \Im(\beta))}
{\sqrt{(|\alpha-\lambda_{+}|^2+\beta^{\star}\beta)
(|\alpha-\lambda_{-}|^2+\beta^{\star}\beta)}}
\end{equation}

\begin{equation}
<\lambda_-|\hat J_b|\lambda_+>=
\frac{-2B \beta^{\star} \beta}
{\sqrt{(|\alpha-\lambda_{+}|^2+\beta^{\star}\beta)
(|\alpha-\lambda_{-}|^2+\beta^{\star}\beta)}}
\end{equation}

\begin{equation}
<\lambda_-|\hat J_c|\lambda_+>=
\frac{2|C| (-\alpha\Im(\beta)+i\lambda_+ \Re(\beta))}
{\sqrt{(|\alpha-\lambda_{+}|^2+\beta^{\star}\beta)
(|\alpha-\lambda_{-}|^2+\beta^{\star}\beta)}}
\end{equation}

The module given in {\prg /examples/cecu2a/kramer.c} can be compiled
by typing make in the directory {\prg /examples/cecu2a/} thus using the
{\prg  /examples/cecu2a/makefile}. It diagonalises
the Hamiltonian (\ref{ham}) and calculates the thermal expectation 
value $<>_T$ of the vector $\mbf J$. The moment ${\mbf M}=g_J \mu_B <{\mbf J}>_T$
is returned to the mcphas\index{mcphas} program:

\input{../examples/cecu2a/1ion_mod/kramer.c}
