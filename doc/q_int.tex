\section{Including Quadrupolar and Higher Order Interactions}
\label{qint}


Some modules such as {\prg so1ion}\index{so1ion}
 allow also to calculate systems with higher order interactions such
as quadrupolar interactions. Quadrupolar and higher order interactions can be calculated, which
can be described by products of Stevens operators. The general two ion exchange coupling is

\begin{equation}
\label{multipolehamiltonrepeated}
 {\mathcal H}_{JJ}=
             -\frac{1}{2}  \sum_{nn'} \sum_ {ll'} \sum_{mm'}
     {\mathcal K}_{ll'}^{mm'}(nn') \hat O_{lm}({\mbf J}^n) \hat O_{l'm'}({\mbf J}^{n'})
=-\frac{1}{2}  \sum_{nn'} \sum_{\stackrel{\alpha=(lm)}{ \alpha'=(l'm')}} J_{\alpha\alpha'}(nn') 
\hat I_{\alpha}^n \hat I_{\alpha'}^{n'}
\end{equation}

For further information on the notation and symmetry restrictions to the
parameters in the Hamiltonian refer to~\cite{jensen91-1}.


\subsection{Setting up {\prg mcphas.j\index{mcphas.j}} and other input files}

In order to include the higher order interactions, the number of columns in the input file
{\prg mcphas.j\index{mcphas.j}} has to be increased. The additional columns then
 contain the higher order exchange constants.

Using the module {\prg so1ion}, the input file {\prg mcphas.j\index{mcphas.j}} may look as given for the 
example GdRu$_2$Si$_2$ in {\prg examples/gdru2si2}:

{\footnotesize
\begin{verbatim}
# GdRu2Si2 anisotropic bilinear and biquadratic exchange 
#<!--mcphase.mcphas.j-->
#***************************************************************
# Lattice and Exchange Parameter file for
# mcphas version 3.0
# - program to calculate static magnetic properties
# reference: M. Rotter JMMM 272-276 (2004) 481
# mcdisp version 3.0
# - program to calculate the dispersion of magnetic excitations
# reference: M. Rotter et al. J. Appl. Phys. A74 (2002) 5751
#***************************************************************
#
# Lattice Constants (A)
#! a=4.165 b=4.165 c=9.654 alpha=  90 beta=  90 gamma=  90
#! r1a= 0.5 r2a=   0 r3a=   0
#! r1b= 0.5 r2b=   1 r3b=   0   primitive lattice vectors [a][b][c]
#! r1c= 0.5 r2c=   0 r3c=   1
#! nofatoms=1  nofcomponents=8  number of atoms in primitive unit cell/number of components of each spin
#****************************************************************************}
#! da=   0 [a] db=   0 [b] dc=   0 [c] nofneighbours=38 diagonalexchange=1 gJ=   2 sipffilename=Gd3p.sipf
# da[a]    db[b]      dc[c]       J11[meV]  J22[meV]  J33[meV]  J44[meV]  J55[meV]  J66[meV]  J77[meV]  Jbc[meV]  %%@
J88[meV]} 
-1.0 0.0 0.0 0.08390 0.08390 0.21890 -0.0024 -0.0096 -0.0008 -0.0096 -0.0024 
1.0 0.0 0.0 0.08390 0.08390 0.21890 -0.0024 -0.0096 -0.0008 -0.0096 -0.0024 
0.0 -1.0 0.0 0.08390 0.08390 0.21890 -0.0024 -0.0096 -0.0008 -0.0096 -0.0024 
0.0 1.0 0.0 0.08390 0.08390 0.21890 -0.0024 -0.0096 -0.0008 -0.0096 -0.0024 
-0.5 -0.5 -0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
-0.5 -0.5 0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
-0.5 0.5 -0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
-0.5 0.5 0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
0.5 -0.5 -0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
0.5 -0.5 0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
0.5 0.5 -0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
0.5 0.5 0.5 0.00380 0.00380 0.01000 0.0 0.0 0.0 0.0 0.0 
-1.0 -1.0 0.0 -0.03630 -0.03630 -0.09445 0.0 0.0 0.0 0.0 0.0 
-1.0 1.0 0.0 -0.03630 -0.03630 -0.09445 0.0 0.0 0.0 0.0 0.0 
1.0 -1.0 0.0 -0.03630 -0.03630 -0.09445 0.0 0.0 0.0 0.0 0.0 
1.0 1.0 0.0 -0.03630 -0.03630 -0.09445 0.0 0.0 0.0 0.0 0.0 
1.5 -0.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-1.5 -0.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
1.5 -0.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
0.5 -1.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
0.5 1.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
0.5 1.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-0.5 1.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-1.5 -0.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
1.5 0.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-1.5 0.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-0.5 -1.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-0.5 -1.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
1.5 0.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-0.5 1.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-1.5 0.5 0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
0.5 -1.5 -0.5 -0.00072 -0.00072 -0.00188 0.0 0.0 0.0 0.0 0.0 
-2.0 0.0 0.0 -0.01754 -0.01754 -0.04567 0.0 0.0 0.0 0.0 0.0 
2.0 0.0 0.0 -0.01754 -0.01754 -0.04567 0.0 0.0 0.0 0.0 0.0 
0.0 -2.0 0.0 -0.01754 -0.01754 -0.04567 0.0 0.0 0.0 0.0 0.0 
0.0 2.0 0.0 -0.01754 -0.01754 -0.04567 0.0 0.0 0.0 0.0 0.0 
0.0 0.0 1.0 0.24850 0.24850 0.13560 0.0 0.0 0.0 0.0 0.0 
0.0 0.0 -1.0 0.24850 0.24850 0.13560 0.0 0.0 0.0 0.0 0.0 
\end{verbatim}
}
here the meaning of the J11, J22, J33, J44, J55 \dots is the 
exchange constant $J_{\alpha\alpha}$ between the operators $\hat I_1 \cdot \hat I_1$, $\hat I_2 \cdot \hat I_2$,
$\hat I_3 \cdot \hat I_3$, $\hat I_4 \cdot \hat I_4$, ... etc. in equation (\ref{multipolehamiltonrepeated}).
Note that in our notation the indices of the interaction operators $\hat \mbf I$ are sometimes
denoted by numbers, sometimes by characters: $\hat I_1,\hat I_2,\hat I_3, \hat I_4, \dots \equiv \hat I_a,\hat I_b,\hat I_c, \hat I_d, \dots$.

By default in module {\prg so1ion} the operator sequence is $\hat I_1,\hat I_2,\hat I_3, \hat I_4, \dots =$
$\hat O_{11}$,$\hat O_{11}^s$, $\hat O_{10}$, $\hat O_{22}^s$, $\hat O_{21}^s$,$\hat O_{20}$,
$\hat O_{21}$,$\hat O_{22}$,$\hat O_{33}^s$, ...
according to equation (\ref{multipolehamiltonrepeated}) and table~\ref{olms}.
 The exchange constants for the
products of these Stevens operators have to be 
given according to the following scheme:

\begin{verbatim}
   11 22 33 12 21 13 31 23 32 (3x3 matrix)
   11 22 33 44 12 21 13 31 14 41 23 32 24 42 34 43 (4x4 matrix)
   11 22 33 44 55 12 21 13 31 14 41 15 51 23 32 24 42 25 52 34 43 35 53 45 54 (5x5 matrix)
   etc ...
\end{verbatim}

The other input and output files have the same format as usual, but with the modification, that
there are now $n$ components of the 'spins' in {\prg mcphas.sps} instead of 3 ($<\hat J_a>$,$<\hat J_b>$,$<\hat J_c>$).
The expectation values of the operators
 $<\hat I_a>$,$<\hat I_b>$,$<\hat I_c>$,$<\hat I_d>$,$<\hat I_e>$, etc. correspond to the
interaction operator sequence of the single ion module, which for {\prg so1ion} is 
by default $<\hat J_a>$,$<\hat J_b>$,$<\hat J_c>$,
 $<\hat O_{22}^s>$, $<\hat O_{21}^s>$,$<\hat O_{20}>$,$<\hat O_{21}>$,$<\hat O_{22}>$,$<\hat O_{33}^s>$, ...
 respectively.
 Table~\ref{olms} contains a list of first and second order Stevens parameters.
For a full list please refer to appendix~\ref{stevens}.

Note that the $\hat I_{\alpha}$ may be completely redefined
 by perl parsing the single ion property file - see section \ref{simod} for details.
This may be useful to shorten notation, if by symmetry the coupling (\ref{multipolehamiltonrepeated}) 
may be rewritten in products of linear combinations of operators such as needed
for pseudo spin models of multipolar order~\cite{shiina97-1741},
 e.g 
$(5\hat  O_{44}(\hat \mbf J^n)+\hat  O_{40}(\hat \mbf J^n)) \cdot (5 \hat O_{44}(\hat \mbf J^{n'})+\hat  O_{40}(\hat \mbf J^{n'}))$


\begin{table}[hb] 
\begin{center}  
\caption {Stevens operator equivalents $O_{lm}$ and 
corresponding notation used in modules {\prg cfield\index{cfield}} and 
{\prg so1ion\index{so1ion}} 
($\hat J_{\pm}=\hat J_x\pm i\hat J_y)$. For a full list please refer to appendix~\ref{stevens}.}   
\label{olms}   
\begin{tabular} 
{lrr} 
Stevens Operator & Notation used in module {\prg so1ion\index{so1ion}} & {\prg cfield\index{cfield}} \\
\hline
$\hat O_{00}=1$ ($O_{00}({\rm so1ion})=0$) &\\
\hline
$\hat O_{11}=\frac{1}{2}[\hat J_++\hat J_-]=\hat J_x$ &  $\hat I_a$&  $\hat I_c$\\
$\hat O_{11}(s)=\frac{-i}{2}[\hat J_+-\hat J_-]=\hat J_y$ &  $\hat I_b$&  $\hat I_a$\\
$\hat O_{10}=\hat J_z$   & $\hat I_c$&  $\hat I_b$ \\
\hline
$\hat O_{22}(s)=\frac{-i}{2}[\hat J_+^2-\hat J_-^2]=\hat J_x\hat J_y+\hat J_y\hat J_x$($=2\hat P_{xy}$) & $\hat I_d$ & $\hat I_d$ \\
$\hat O_{21}(s)=\frac{-i}{4}[(\hat J_+-\hat J_-)\hat J_z+\hat J_z(\hat J_+-\hat J_-)]=\frac{1}{2}[\hat J_y\hat J_z+\hat J_z\hat J_y]$($=\hat P_{yz}$) & $\hat I_e$& $\hat I_e$  \\
$\hat O_{20}=[3\hat J_z^2-J(J+1)]$ ($O_2^0(s)=0$) & $\hat I_f$& $\hat I_f$  \\
$\hat O_{21}=\frac{1}{4}[(\hat J_++\hat J_-)\hat J_z+\hat J_z(\hat J_++\hat J_-)]=\frac{1}{2}[\hat J_x\hat J_z+\hat J_z\hat J_x]$($=\hat P_{xz}$) & $\hat I_g$& $\hat I_g$  \\
$\hat O_{22}=\frac{1}{2}[\hat J_+^2+\hat J_-^2]=[\hat J_x^2-\hat J_y^2]$ & $\hat I_h$& $\hat I_h$  \\
\hline
 \end{tabular}
\end{center}   
\end{table}

\subsection{Option {\prg indexexchange} in order to shorten notation in {\prg mcphas.j}}
The {\prg indexexchange} parameter discussed in section~\ref{mcphasj} may be useful in keeping the input
of the exchange components short. For example the $\zeta$ and $\eta$ strain modes on the quasi-cubic sites
of a double hexagonal close packed structure involves the coupling of $\hat P_{zx}$ ($\hat I_g$) and $\hat P_{xy}$ ($\hat I_d$) 
as well as $\hat P_{yz}$ ($\hat I_e$) and $\hat O_2^2$ $(\hat I_h)$ quadrupoles, so the {\prg diagonalexchange=1} option 
cannot be used. Thus 64 components need to be specified to describe the $8\times 8$ exchange tensor. 
However, we can simplify this with the {\prg indexexchange} parameter by setting {\prg diagonalexchange=2}, 
as follows for UPd$_3$:

{\footnotesize \begin{verbatim}
# UPd3 
#<!--mcphase.mcphas.j-->
#! a=9.92465 b=5.73 c=9.65  alpha=  90 beta=  90 gamma=  90
#! r1x= 1 r2x=   0 r3x=   0
#! r1y= 0 r2y=   1 r3y=   0
#! r1z= 0 r2z=   0 r3z=   1
#! nofatoms=1 nofcomponents=8
#*************************************************************************
#! x=   0 [a] y=   0 [b] z=   0 nofneighbours=6 diagonalexchange=2 gJ=0.8 sipffilename=mcphas.cf1
#! x[a]  y[b]    z[c]   Ja[meV]  Jb[meV]  Jc[meV]  Jd[meV]  Je[meV]  Jf[meV]  Jg[meV]  Jh[meV]
#! symmetricexchange=1 indexexchange= JaJa JbJb JcJc JdJd JeJe JfJf JgJg JhJh JgJd JhJe
 0    0    0.5 -0.022 -0.022 -0.022  0.0035198 -0.18643  -0.00053332 -0.18643   0.00087996  0.013      0.0064378
 0    0   -0.5 -0.022 -0.022 -0.022  0.0035198 -0.18643  -0.00053332 -0.18643   0.00087996  0.013      0.0064378
 0.5  0.5  0   -0.022 -0.022 -0.022 -0.0034195 -0.019714 -0.00034044 -0.019714 -0.00085486 -0.0065221 -0.0050197
-0.5 -0.5  0   -0.022 -0.022 -0.022 -0.0034195 -0.019714 -0.00034044 -0.019714 -0.00085486 -0.0065221 -0.0050197
 0.5 -0.5  0   -0.022 -0.022 -0.022 -0.0034195 -0.019714 -0.00034044 -0.019714 -0.00085486 -0.0065221 -0.0050197
-0.5  0.5  0   -0.022 -0.022 -0.022 -0.0034195 -0.019714 -0.00034044 -0.019714 -0.00085486 -0.0065221 -0.0050197
\end{verbatim} }



\subsection{Running {\prg McPhase} and {\prg McDisp}}

The programs {\prg mcphas} and {\prg mcdisp\index{mcdisp}} are run completely the same way as usual, only
the output files contain also information about the (thermal) expectation values of $<O_l^m>$
dependent on temperature and magnetic field. 
Using the module so1ion the notation $<\hat J_a>$,$<\hat J_b>$,$<\hat J_c>$,
$<\hat J_d>$, $<\hat J_e>$, etc. correspond to $<J_a>$, $<J_b>$,
$<J_c>$, $<O_{22}(s)>$, $<O_{21}(s)>$,$<O_{20}>$,$<O_{21}>$,$<O_{22}>$,$<O_{33}(s)>$, ...
 respectively.
Note that by the higher order interactions not only the static properties are changed, but also the
dispersion of the magnetic excitations is influenced.


The directory {\prg examples/gdru2si2} contains an example of a simulation of biquadratic (i.e. isotropic %%@
quadrupolar) interactions leading to an improved description of magnetic susceptibility.

For DyCu$_2$ the conversion
of the magnetic axis due to quadrupolar exchange has been calculated according to the model 
\cite{yoshida98-1421}. The calculated quadrupolar phase diagram is shown in figure~\ref{qphased}.

\begin{figure}[hb]%h=here, t=top, b=bottom, p=separate figure page
\begin{center}\leavevmode
\includegraphics[angle=-90, width=0.5\textwidth]{figsrc/dyphased.ps}
\end{center}
\caption{DyCu$_2$: calculated quadrupolar phased diagram. When applying a large magnetic field
parallel to the $c$ axis of the orthorhombic crystal, the system undergoes a structural transformation
associated with a reorientation of the structural unit cell. This effect can be modelled by a large
quadrupolar interaction.[plot created with program {\prg phased}]}
\label{qphased}
\end{figure}

When large  quadrupolar interactions are present, the excitation spectrum is changed and
quadrupolar modes (orbitons) with a finite dispersion are expected. 
These modes correspond to an cooperative oscillation of the quadrupolar moments such as shown
in figure~\ref{qmodes}.
The program {\prg mcdisp\index{mcdisp}}
is able to calculate this dispersion and the corresponding neutron scattering cross section as shown
in figure~\ref{qintensity} for the case of PrCu$_2$. 
 

\begin{figure}[hb]%h=here, t=top, b=bottom, p=separate figure page
\begin{center}\leavevmode
\includegraphics[angle=0, width=0.6\textwidth]{figsrc/orbiton.ps}
\end{center}
\caption{Orbital excitations viewed  as correlated changes in 4f-charge densities.}
\label{qmodes}
\end{figure}

\begin{figure}[hb]%h=here, t=top, b=bottom, p=separate figure page
\begin{center}\leavevmode
\includegraphics[angle=0, width=0.5\textwidth]{figsrc/prcu2_0k0_5T.eps}
\end{center}
\caption{PrCu$_2$: calculated dispersion of quadrupolar excitations in a field of 5 Tesla parallel to the $a$ axis %%@
of this orthorhombic system.
[plot created with program {\prg displaycontour\index{displaycontour}}]}
\label{qintensity}
\end{figure}

\clearpage