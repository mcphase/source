#!/usr/bin/perl
#
# ptgplookup.pl - Looks up tables for elements and characters of point groups
#
# This program is part of the McPhase package, licensed under the GNU GPL v2. Please see the COPYING
# file
#
# Thu Dec 16 15:23:01 WEST 2010 - Duc Le and Martin Rotter

use Switch;
use Math::Trig;
use Math::Complex;

# Stores the order and operators of each point group as a global hash of arrays
#   List is taken from: http://newton.ex.ac.uk/research/qsystems/people/goss/symmetry/CC_All.html
%ptgp = (                                                                 # Duplicate names   # Number in Intl. Tables
    C1  => [1,  1,  "E"],                                                                         # 1        1
    Ci  => [2,  2,  "E", "i"],                                                #   *               # 2       -1
    S2  => [2,  2,  "E", "i"],                                                #   *               # 2       -1
    C2  => [2,  2,  "E", "C2"],                                                                   # 3        2
    Cs  => [2,  2,  "E", "sh"],                                               #   *               # 4        m
    C1h => [2,  2,  "E", "sh"],                                               #   *               # 4        m
    C2h => [4,  4,  "E", "C2",  "i", "sh"],                                                       # 5      2/m
    D2  => [4,  4,  "E", "C2",  "C2p", "C2pp"],                               #   *               # 6      222
    V   => [4,  4,  "E", "C2",  "C2p", "C2pp"],                               #   *               # 6      222
    C2v => [4,  4,  "E", "C2",  "sv", "svp"],                                                     # 7      mm2
    D2h => [8,  8,  "E", "C2",  "C2p", "C2pp", "i", "sh", "sv", "svp"],       #   *               # 8      mmm
    Vh  => [8,  8,  "E", "C2",  "C2p", "C2pp", "i", "sh", "sv", "svp"],       #   *               # 8      mmm
    C4  => [4,  4,  "E", "C4",  "C2", "C43"],                                                     # 9        4
    S4  => [4,  4,  "E", "S4",  "C2", "S43"],                                                     # 10      -4
    C4h => [8,  8,  "E", "C4",  "C2", "C43", "i", "S43", "sh", "S4"],                             # 11     4/m
    D4  => [5,  8,  "E", "2C4", "C2", "2C2p", "2C2pp"],                                           # 12     422
    C4v => [5,  8,  "E", "2C4", "C2", "2sv", "2sd"],                                              # 13     4mm
    D2d => [5,  8,  "E", "2S4", "C2", "2C2p", "2sd"],                         #   *               # 14     42m
    Vc  => [5,  8,  "E", "2S4", "C2", "2C2p", "2sd"],                         #   *               # 14     42m
    D4h => [10, 16, "E", "2C4", "C2", "2C2p", "2C2pp", "i", "2S4", "sh", "2sv", "2sd"],           # 15   4/mmm
    C3  => [3,  3,  "E", "C3",  "C32"],                                                           # 16       3
    S6  => [6,  6,  "E", "C3",  "C32", "i", "S65", "S6"],                     #   *               # 17      -3
    C3i => [6,  6,  "E", "C3",  "C32", "i", "S65", "S6"],                     #   *               # 17      -3
    D3  => [3,  6,  "E", "2C3", "3C2"],                                                           # 18     321
    C3v => [3,  6,  "E", "2C3", "3sv"],                                                           # 19     31m
    D3d => [6,  12, "E", "2C3", "3C2", "i", "2S6", "3sd"],                                        # 20    -31m
    C6  => [6,  6,  "E", "C6",  "C3", "C2", "C32", "C65"],                                        # 21       6
    C3h => [6,  6,  "E", "C3",  "C32", "sh", "S3", "S32"],                    #   *               # 22      -6
    S3  => [6,  6,  "E", "C3",  "C32", "sh", "S3", "S32"],                    #   *               # 22      -6
    C6h => [12, 12, "E", "C6",  "C3", "C2", "C32", "C65", "i", "S32", "S65", "sh", "S6", "S3"],   # 23     6/m
    D6  => [6,  12, "E", "2C6", "2C3", "C2", "3C2p", "3C2pp"],                                    # 24     622
    C6v => [6,  12, "E", "2C6", "2C3", "C2", "3sv", "3sd"],                                       # 25     6mm
    D3h => [6,  12, "E", "2C3", "3C2", "sh", "2S3", "3sv"],                                       # 26     62m
    D6h => [12, 24, "E", "2C6", "2C3", "C2", "3C2p", "3C2pp", "i", "2S3", "2S6","sh","3sd","3sv"],# 27   6/mmm
    T   => [4,  12, "E", "3C2", "4C3", "4C3p"],                                                   # 28      23
    Th  => [8,  24, "E", "4C3", "4C32", "3C2", "i", "4S65", "4S6", "3sv"],                        # 29      m3
    O   => [5,  24, "E", "8C3", "3C2", "6C2p", "6C4"],                                            # 30     432
    Td  => [5,  24, "E", "8C3", "3C2", "6S4", "6sd"],                                             # 31     43m
    Oh  => [10, 48, "E", "8C3", "6C2", "6C4", "3C2p", "i", "6S4", "8S6", "3sh", "6sd"]            # 32     m3m
);

# Stores the angles of rotation equivalent to each operator of a group as a hash of arrays.
#   Note that this is just the final angles of rotation, and that mirror planes are treated as rotation by 180deg.
%rang = (                                                                 # Duplicate names   # Number in Intl. Tables
    C1  => [0],                                                                               # 1        1
    Ci  => [0, 0],                                                        #   *               # 2       -1  (no. 2)
#   Ci  => [E, i]
    S2  => [0, 0],                                                        #   *               # 2       -1
    C2  => [0, pi],                                                                           # 3        2
    C1h => [0, pi],                                                       #   *               # 4        m
    Cs  => [0, pi],                                                       #   *               # 4        m
#   Cs  => [E, sh]
    C2h => [0, pi,  pi, pi],                                                                  # 5      2/m  (no. 10)
#   C2h => [E, C2,  i,  sh]
    D2  => [0, pi,  pi, pi],                                              #   *               # 6      222
    V   => [0, pi,  pi, pi],                                              #   *               # 6      222
    C2v => [0, pi,  pi, pi],                                                                  # 7      mm2  (no. 25)
#   C2v => [E, C2,  sv, svp]
    Vh  => [0, pi,  pi, pi, pi, pi, pi, pi],                              #   *               # 8      mmm
    D2h => [0, pi,  pi, pi, pi, pi, pi, pi],                              #   *               # 8      mmm  (no. 47)
#   D2h => [E, C2, C2p, C2pp,i,sh, sv, svp]
    C4  => [0, pi/2,  pi, 3*pi/2],                                                            # 9        4
    S4  => [0, pi/2,  pi, 3*pi/2],                                                            # 10      -4
    C4h => [0, pi/2,  pi, 3*pi/2, 0,  3*pi/2, pi, pi/2],                                      # 11     4/m  (no. 83)
#   C4h => [E, C4,    C2, C43,    i,  S43,    sh, S4]
    D4  => [0, pi/2, pi, pi, pi],                                                             # 12     422
    C4v => [0, pi/2, pi, pi, pi],                                                             # 13     4mm  (no. 99)
#   C4v => [E, 2C4,  C2, 2sv,  2sd]
    Vc  => [0, pi/2, pi, pi, pi],                                         #   *               # 14     42m
    D2d => [0, pi/2, pi, pi, pi],                                         #   *               # 14     42m  (no. 111)
#   D2d => [E, 2S4,  C2,2C2p, 2sd]
    D4h => [0, pi/2, pi, pi, pi,  0, pi/2, pi, pi, pi],                                       # 15   4/mmm  (no. 123)
#   D4h => [E, 2C4, C2,2C2p,2C2pp,i, 2S4, sh, 2sv,  2sd]
    C3  => [0, 2*pi/3,  4*pi/3],                                                              # 16       3
    S6  => [0, 2*pi/3,  4*pi/3, 0, 4*pi/3, 2*pi/3],                       #   *               # 17      -3
#   S6  => [E, C3,      C32",   i,  S65,    S6]
    C3i => [0, 2*pi/3,  4*pi/3, 0, 4*pi/3, 2*pi/3],                       #   *               # 17      -3  (no. 147)
#   C3i => [E, C3,      C32,    i,  S65,    S6]
    D3  => [0, 2*pi/3, pi],                                                                   # 18     321
    C3v => [0, 2*pi/3, pi],                                                                   # 19     31m  (no. 156)
#   C3v => [E, 2C3,    3sv]
    D3d => [0, 2*pi/3, pi, 0, 4*pi/3, pi],                                                    # 20    -31m  (no. 162)
#   D3d => [E, 2C3,   3C2, i,  2S6,  3sd]
    C6  => [0, pi/3,  2*pi/3, pi, 4*pi/3, 5*pi/3],                                            # 21       6
    S3  => [0, 2*pi/3, 4*pi/3, pi, pi/3, 5*pi/3],                         #   *               # 22      -6
#   S3  => [E, C3,     C32,    sh, S3,   S32]
    C3h => [0, 2*pi/3, 4*pi/3, pi, pi/3, 5*pi/3],                         #   *               # 22      -6
#   C3h => [E, C3,     C32,    sh, S3,   S32]
    C6h => [0, pi/3, 2*pi/3, pi, 4*pi/3, 5*pi/3, 0,  5*pi/3, 4*pi/3, pi, 2*pi/3, pi/3],       # 23     6/m  (no. 175)
   #C6h => [0, pi/3, 2*pi/3, pi, 4*pi/3, 5*pi/3, 0,  4*pi/3, 5*pi/3, pi, pi/3, 2*pi/3],       # 23     6/m  (no. 175)
#   C6h => [E, C6,   C3,     C2, C32,    C65,    i,  S32,    S65,    sh,  S6,  S3]
    D6  => [0, pi/3, 2*pi/3, pi, pi, pi],                                                     # 24     622
    C6v => [0, pi/3, 2*pi/3, pi, pi, pi],                                                     # 25     6mm  (no. 183)
#   C6v => [E, 2C6,  2C3",   C2, 3sv,  3sd]
    D3h => [0, 2*pi/3, pi, pi,  pi/3, pi],                                                    # 26     62m  (no. 187)
#   D3h => [E, 2C3,   3C2, sh,  2S3,  3sv]
    D6h => [0, pi/3, 2*pi/3, pi, pi, pi,    0, pi/3, 2*pi/3, pi,  pi,  pi],                   # 27   6/mmm  (no. 191)
#   D6h => [E, 2C6,  2C3,    C2,3C2p,3C2pp, i,  2S3,   2S6,  sh,  3sd, 3sv]
    T   => [0, pi, 2*pi/3, 4*pi/3],                                                           # 28      23
#   T   => [E, 3C2,   4C3, 4C3p]
    Th  => [0, 2*pi/3, 4*pi/3,  pi,  0, 4*pi/3, 2*pi/3, pi],                                  # 29      m3  (no. 200)
#   Th  => [E, 4C3,    4C32,    3C2, i, 4S65,   4S6,    3sv]
#   Th  => [E, 8C3,    3C2, 3sv,  i,  8S6]
    O   => [0, 2*pi/3, pi, pi, pi/2],                                                         # 30     432
    Td  => [0, 2*pi/3, pi, pi/2, pi],                                                         # 31     43m  (no. 215)
#   Td  => [E, 8C3,   3C2, 6S4,  6sd]
    Oh  => [0, 2*pi/3, pi, pi/2, pi,  0, pi/2, 2*pi/3, pi, pi]                                # 32     m3m  (no. 221)
#   Oh  => [E, 8C3,   6C2, 6C4, 3C2p, i, 6S4,  8S6,   3sh, 6sd]
);

# Table of [phi,theta] angles for the Buckmaster rotation operator representation of each element of the group. 
#   Note that mirror planes are treated as a pi-rotation about the axis perpendicular to the plane, 
#   followed by an inversion (which has no effect in this case).
$tr=asin(sqrt(2/3));  # theta angle to get to trigonal (111) axis.
%rops = (                                                                 # Duplicate names   # Number in Intl. Tables
    C1  => [ ["E", [0,0]] ],                                                                  # 1        1
    Ci  => [ ["E", [0,0]], ["i",  [0,0]] ],                                            #      # 2       -1  (no. 2)
    S2  => [ ["E", [0,0]], ["i",  [0,0]] ],                                            #      # 2       -1  (no. 2)
    C2  => [ ["E", [0,0]], ["C2", [pi,0]] ],                                                  # 3        2
    Cs  => [ ["E", [0,0]], ["sh", [pi,0]] ],                                           #      # 4        m
    C1h => [ ["E", [0,0]], ["sh", [pi,0]] ],                                           #      # 4        m
    C2h => [ ["E", [0,0]], ["C2", [pi,0]],     ["i", [0,0]],     ["sh", [pi,0]] ],            # 5      2/m  (no. 10)
    D2  => [ ["E", [0,0]], ["C2x",[pi,pi]],    ["C2y",[0,pi]],   ["C2z",[pi,0]] ],     #      # 6      222
    V   => [ ["E", [0,0]], ["C2x",[pi,pi]],    ["C2y",[0,pi]],   ["C2z",[pi,0]] ],     #      # 6      222
    C2v => [ ["E", [0,0]], ["C2", [pi,0]],     ["sv(xz)",[0,pi]],["sv(yz)",[pi,pi]] ],        # 7      mm2  (no. 25)
    D2h => [ ["E", [0,0]], ["C2x",[pi,pi]],    ["C2y",[0,pi]],   ["C2z",[pi,0]],       #      # 8      mmm  (no. 47)
             ["i", [0,0]], ["s(xy)",[pi,pi]],  ["s(xz)",[0,pi]], ["s(yz)",[pi,0]] ],
    Vh  => [ ["E", [0,0]], ["C2x",[pi,pi]],    ["C2y",[0,pi]],   ["C2z",[pi,0]],       #      # 8      mmm  (no. 47)
             ["i", [0,0]], ["s(xy)",[pi,pi]],  ["s(xz)",[0,pi]], ["s(yz)",[pi,0]] ],
    C4  => [ ["E", [0,0]], ["C2", [pi,0]],     ["C4", [pi/2,0]], ["C4^3",[3*pi/2,0]] ],       # 9        4
    S4  => [ ["E", [0,0]], ["C2", [pi,0]],     ["S4", [pi/2,0]], ["S4^3",[3*pi/2,0]] ],       # 10      -4
    C4h => [ ["E", [0,0]], ["C2", [pi,0]],     ["C4", [pi/2,0]], ["C4^3",[3*pi/2,0]],         # 11     4/m  (no. 83)
             ["i", [0,0]], ["S4^3",[3*pi/2,0]],["sh", [pi,0]],   ["S4",[pi/2,0]] ],
    D4  => [ ["E", [0,0]], ["C2(z)", [pi,0]],  ["C4", [pi/2,0]], ["C4^3",[3*pi/2,0]],         # 12     422
             ["C2(1)",[0,pi]], ["C2(2)",[pi/2,pi]], ["C2(3)",[pi,pi]], ["C2(4)",[3*pi/2,pi]] ],
    C4v => [ ["E", [0,0]], ["C2(z)", [pi,0]],  ["C4", [pi/2,0]], ["C4^3",[3*pi/2,0]],         # 13     4mm  (no. 99)
             ["sv(1)",[0,pi]], ["sv(2)",[pi,pi]], ["sd(1)",[pi/2,pi]], ["sd(2)",[3*pi/2,pi]] ],
    D2d => [ ["E", [0,0]], ["C2(z)", [pi,0]],  ["S4", [pi/2,0]], ["S4^3",[3*pi/2,0]],  #      # 14     42m  (no. 111)
             ["C2(1)",[0,pi]], ["C2(2)",[pi,pi]], ["sd(1)",[pi/2,pi]], ["sd(2)",[3*pi/2,pi]] ],
    Vc  => [ ["E", [0,0]], ["C2(z)", [pi,0]],  ["S4", [pi/2,0]], ["S4^3",[3*pi/2,0]],  #      # 14     42m  (no. 111)
             ["C2(1)",[0,pi]], ["C2(2)",[pi,pi]], ["sd(1)",[pi/2,pi]], ["sd(2)",[3*pi/2,pi]] ],
    D4h => [ ["E", [0,0]], ["C4", [pi/2,0]],   ["C4^3", [3*pi/2,0]], ["C2(z)",[pi,0]],        # 15   4/mmm  (no. 123)
             ["C2(1)",[0,pi]], ["C2(2)",[pi,pi]], ["C2(3)",[pi/2,pi]], ["C2(4)",[3*pi/2,pi]],
             ["i", [0,0]], ["S4", [pi/2,0]],   ["S4^3", [3*pi/2,0]], ["sh",[pi,0]],
             ["sv(1)",[0,pi]], ["sv(2)",[pi,pi]], ["sd(1)",[pi/2,pi]], ["sd(1)",[3*pi/2,pi]] ],
    C3  => [ ["E", [0,0]], ["C3", [2*pi/3,0]], ["C3^2", [4*pi/3,0]] ],                        # 16       3
    S6  => [ ["E", [0,0]], ["C3", [2*pi/3,0]], ["C3^2", [4*pi/3,0]],                   #      # 17      -3  (no. 147)
             ["i", [0,0]], ["S6^5",[4*pi/3,0]],["S6", [2*pi/3,0]] ],
    C3i => [ ["E", [0,0]], ["C3", [2*pi/3,0]], ["C3^2", [4*pi/3,0]],                   #      # 17      -3  (no. 147)
             ["i", [0,0]], ["S6^5",[4*pi/3,0]],["S6", [2*pi/3,0]] ],
    D3  => [ ["E", [0,0]], ["C3", [2*pi/3,0]], ["C3^2", [4*pi/3,0]],                          # 18     321
             ["C2(1)",[0,pi]], ["C2(2)",[2*pi/3,pi]], ["C2(3)",[4*pi/3,pi]] ],
    C3v => [ ["E", [0,0]], ["C3", [2*pi/3,0]], ["C3^2", [4*pi/3,0]],                          # 19     31m  (no. 156)
             ["sv(1)",[0,pi]], ["sv(2)",[2*pi/3,pi]], ["sv(3)",[4*pi/3,pi]] ],
    D3d => [ ["E",     [0,0]],         ["i",     [0,0]],                                      # 20    -31m  (no. 162)
             ["C3(1)", [2*pi/3,0]],    ["S6(1)", [2*pi/3,0]],
             ["C3(2)", [4*pi/3,0]],    ["S6(2)", [4*pi/3,0]],
             ["C2(1)", [0,pi]],        ["sd(1)", [0,pi]],
             ["C2(2)", [2*pi/3,pi]],   ["sd(2)", [2*pi/3,pi]],
             ["C2(3)", [4*pi/3,pi]],   ["sd(3)", [4*pi/3,pi]] ],
    C6  => [ ["E", [0,0]], ["C6", [pi/3,0]],    ["C3", [2*pi/3,0]],                           # 21       6
             ["C2",[pi,0]],["C3^2",[4*pi/3,0]], ["C6^5",[5*pi/3,0]] ],
    S3  => [ ["E", [0,0]], ["C3", [2*pi/3,0]],  ["C3^2",[4*pi/3,0]],                   #      # 22      -6
             ["sh",[pi,0]],["S3", [pi/3,0]],    ["S3^2",[pi/-3,0]] ],
    C3h => [ ["E", [0,0]], ["C3", [2*pi/3,0]],  ["C3^2",[4*pi/3,0]],                   #      # 22      -6
             ["sh",[pi,0]],["S3", [pi/3,0]],    ["S3^2",[pi/-3,0]] ],
    C6h => [ ["E", [0,0]], ["C6", [pi/3,0]],    ["C3", [2*pi/3,0]],                           # 23     6/m  (no. 175)
             ["C2",[pi,0]],["C3^2",[4*pi/3,0]], ["C6^5",[5*pi/3,0]],   
             ["i", [0,0]], ["S3^2",[5*pi/3,0]], ["S6^5",[4*pi/3,0]],
             ["sh",[pi,0]],["S6", [2*pi/3,0]],  ["S3", [pi/3,0]] ],
    D6  => [ ["E", [0,0]], ["C2",[pi,0]], ["C3", [2*pi/3,0]],  ["C3^2", [4*pi/3,0]],          # 24     622
             ["C6",[pi/3,0]], ["C6^5",[5*pi/3,0]], ["C2(1)", [0,pi]], ["C2(2)", [pi/3,pi]], 
             ["C2(3)",[2*pi/3,pi]], ["C2(4)",[pi,pi]], ["C2(5)",[4*pi/3,pi]], ["C2(6)",[5*pi/3,pi]] ],
    C6v => [ ["E", [0,0]], ["C2",[pi,0]], ["C3", [2*pi/3,0]],  ["C3^2", [4*pi/3,0]],          # 25     6mm  (no. 183)
             ["C6",[pi/3,0]], ["C6^5",[5*pi/3,0]], ["sv(1)", [0,pi]], ["sv(2)", [2*pi/3,pi]], 
             ["sv(3)",[4*pi/3,pi]], ["sd(1)",[pi/3,pi]], ["sd(2)",[pi,pi]], ["sd(3)",[5*pi/3,pi]] ],
    D3h => [ ["E", [0,0]], ["sh",[pi,0]], ["C3", [2*pi/3,0]],  ["C3^2", [4*pi/3,0]],          # 26     62m  (no. 187)
             ["S3",[pi/3,0]], ["S3^2",[5*pi/3,0]], ["C2(1)", [pi/3,pi]], ["C2(2)", [pi,pi]], 
             ["C2(3)",[5*pi/3,pi]], ["sv(1)",[0,pi]], ["sv(2)",[2*pi/3,pi]], ["sv(3)",[4*pi/3,pi]] ],
    D6h => [ ["E", [0,0]], ["C2",[pi,0]], ["C3", [2*pi/3,0]],  ["C3^2", [4*pi/3,0]],          # 27   6/mmm  (no. 191)
             ["C6",[pi/3,0]], ["C6^5",[5*pi/3,0]], ["C2(1)", [0,pi]], ["C2(2)", [pi/3,pi]], 
             ["C2(3)",[2*pi/3,pi]], ["C2(4)",[pi,pi]], ["C2(5)",[4*pi/3,pi]], ["C2(6)",[5*pi/3,pi]],
             ["i", [0,0]], ["S6", [2*pi/3,0]],  ["S6^5", [4*pi/3,0]], ["S3",[pi/3,0]],
             ["S3^2",[5*pi/3,0]], ["sh",[pi,0]], ["sd(1)", [pi/3,pi]], ["sd(2)", [pi,pi]], 
             ["sd(3)",[5*pi/3,pi]], ["sv(1)",[0,pi]], ["sv(2)",[2*pi/3,pi]], ["sv(3)",[4*pi/3,pi]] ],
    T   => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 28      23
#            ["C3(1)",[pi/-4,0],[0,-$tr],[2*pi/3,0],[pi/4,$tr]],     ["C3^2(1)",[pi/-4,0],[0,-$tr],[4*pi/3,0],[pi/4,$tr]], 
#            ["C3(2)",[pi/-4,0],[0,$tr],[2*pi/3,0],[pi/4,-$tr]],     ["C3^2(2)",[pi/-4,0],[0,$tr],[4*pi/3,0],[pi/4,-$tr]], 
#            ["C3(3)",[3*pi/-4,0],[0,-$tr],[2*pi/3,0],[3*pi/4,$tr]], ["C3^2(3)",[3*pi/-4,0],[0,-$tr],[4*pi/3,0],[3*pi/4,$tr]],
#            ["C3(4)",[3*pi/-4,0],[0,$tr],[2*pi/3,0],[3*pi/4,-$tr]], ["C3^2(4)",[3*pi/-4,0],[0,$tr],[4*pi/3,0],[3*pi/4,-$tr]] ],
             ["C3(1)",[pi/-4,0],[0,-$tr],[2*pi/3,0],[pi/4,$tr]],     ["C3^2(1)",[pi/-4,0],[0,-$tr],[4*pi/3,0],[pi/4,$tr]], 
             ["C3(2)",[pi/-4,0],[0,$tr],[2*pi/3,0],[pi/4,-$tr]],     ["C3^2(2)",[pi/-4,0],[0,$tr],[4*pi/3,0],[pi/4,-$tr]], 
             ["C3(3)",[3*pi/-4,0],[0,-$tr],[2*pi/3,0],[3*pi/4,$tr]], ["C3^2(3)",[3*pi/-4,0],[0,-$tr],[4*pi/3,0],[3*pi/4,$tr]],
             ["C3(4)",[3*pi/-4,0],[0,$tr],[2*pi/3,0],[3*pi/4,-$tr]], ["C3^2(4)",[3*pi/-4,0],[0,$tr],[4*pi/3,0],[3*pi/4,-$tr]] ],
#            ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
#            ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]] ],
              # C3.1: z-> y,  y-> x,  x-> z,  C3.1^2:  z-> x,  x-> y,  y-> z
              # C3.2: z-> x,  x->-y, -y-> z,  C3.2^2:  z->-y, -y-> x,  x-> z 
              # C3.3: z->-y, -y->-x, -x-> z,  C3.3^2:  z->-x, -x->-y, -y-> z 
              # C3.4: z->-x, -x-> y,  y-> z,  C3.4^2:  z-> y,  y->-x, -x-> z 
    Th  => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 29      m3  (no. 200)
             ["i", [0,0]], ["sx",[pi,pi]],  ["sy", [0,pi]],   ["sz", [pi,0]],
             ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]],
             ["S6(1)", [pi/2,pi/2]],  ["S6(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["S6(3)", [3*pi/2,3*pi/2]],  ["S6(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["S6^5(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["S6^5(2)",[pi/2,3*pi/2]],["S6^5(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["S6^5(4)",[3*pi/2,pi/2]] ],
    O   => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 30     432
             ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]],
             ["C2d(1)",[pi/-2,0],[0,pi/-4],[pi,0],[pi/2,pi/4]], ["C2d(2)",[0,pi/-4],[pi,0],[0,pi/4]], ["C2d(3)",[pi/-4,0],[0,pi],[pi/4,0]],
             ["C2d(4)",[pi/-2,0],[0,pi/4],[pi,0],[pi/2,pi/-4]], ["C2d(5)",[0,pi/4],[pi,0],[0,pi/-4]], ["C2d(6)",[pi/4,0],[0,pi],[pi/-4,0]],
              # C2d.1:  x-> z, z-> x | C2d.2:  y-> z, z-> y | C2d.3:  x-> y, y-> x
	      # C2d.4: -x-> z, z->-x | C2d.5: -y-> z, z->-y | C2d.6: -x-> y, y->-x
             ["C4x", [pi/-2,0],[0,pi/2],[pi/2,0]],    ["C4y", [0,pi/2]],   ["C4z",[pi/2,0]], 
	     ["C4x^3",[pi/-2,0],[0,3*pi/2],[pi/2,0]], ["C4y^3",[0,3*pi/2]],["C4z^3",[3*pi/2,0]] ], 
    Td  => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 31     43m  (no. 215)
             ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]],
             ["sd(1)",[pi/-2,0],[0,pi/-4],[pi,0],[pi/2,pi/4]], ["sd(2)",[0,pi/-4],[pi,0],[0,pi/4]], ["sd(3)",[pi/-4,0],[0,pi],[pi/4,0]],
             ["sd(4)",[pi/-2,0],[0,pi/4],[pi,0],[pi/2,pi/-4]], ["sd(5)",[0,pi/4],[pi,0],[0,pi/-4]], ["sd(6)",[pi/4,0],[0,pi],[pi/-4,0]],
             ["S4x", [pi/-2,0],[0,pi/2],[pi/2,0]],    ["S4y", [0,pi/2]],   ["S4z",[pi/2,0]], 
	     ["S4x^3",[pi/-2,0],[0,3*pi/2],[pi/2,0]], ["S4y^3",[0,3*pi/2]],["S4z^3",[3*pi/2,0]] ], 
    Oh  => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 32     m3m  (no. 221)
             ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]],
             ["C2d(1)",[pi/-2,0],[0,pi/-4],[pi,0],[pi/2,pi/4]], ["C2d(2)",[0,pi/-4],[pi,0],[0,pi/4]], ["C2d(3)",[pi/-4,0],[0,pi],[pi/4,0]],
             ["C2d(4)",[pi/-2,0],[0,pi/4],[pi,0],[pi/2,pi/-4]], ["C2d(5)",[0,pi/4],[pi,0],[0,pi/-4]], ["C2d(6)",[pi/4,0],[0,pi],[pi/-4,0]],
             ["C4x", [pi/-2,0],[0,pi/2],[pi/2,0]],    ["C4y", [0,pi/2]],   ["C4z",[pi/2,0]], 
	     ["C4x^3",[pi/-2,0],[0,3*pi/2],[pi/2,0]], ["C4y^3",[0,3*pi/2]],["C4z^3",[3*pi/2,0]],
             ["i", [0,0]], ["shx",[pi,pi]], ["shy", [0,pi]],  ["shz", [pi,0]],
             ["S6(1)", [pi/2,pi/2]],  ["S6(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["S6(3)", [3*pi/2,3*pi/2]],  ["S6(4)", [pi/2,pi/2],[pi/2,pi/2]],
             ["S6^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["S6^2(2)",[pi/2,3*pi/2]],["S6^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["S6^2(4)",[3*pi/2,pi/2]],
             ["sd(1)",[pi/-2,0],[0,pi/-4],[pi,0],[pi/2,pi/4]], ["sd(2)",[0,pi/-4],[pi,0],[0,pi/4]], ["sd(3)",[pi/-4,0],[0,pi],[pi/4,0]],
             ["sd(4)",[pi/-2,0],[0,pi/4],[pi,0],[pi/2,pi/-4]], ["sd(5)",[0,pi/4],[pi,0],[0,pi/-4]], ["sd(6)",[pi/4,0],[0,pi],[pi/-4,0]],
             ["S4x", [pi/-2,0],[0,pi/2],[pi/2,0]],    ["S4y", [0,pi/2]],   ["S4z",[pi/2,0]], 
	     ["S4x^3",[pi/-2,0],[0,3*pi/2],[pi/2,0]], ["S4y^3",[0,3*pi/2]],["S4z^3",[3*pi/2,0]] ]
);

%IRops = (
    C1  => [0],
    Ci  => [0,1],                                                                                                     #
    S2  => [0,1],                                                                                                     #
    C2  => [0,1],
    Cs  => [0,1],                                                                                                     #
    C1h => [0,1],                                                                                                     #
    C2h => [0,1,2,3],
    D2  => [0,1,2,3],                                                                                                 #
    V   => [0,1,2,3],                                                                                                 #
    C2v => [0,1,2,3],
    D2h => [0,1,2,3,4,5,6,7],                                                                                         #
    Vh  => [0,1,2,3,4,5,6,7],                                                                                         #
    C4  => [0,2,1,3],
    S4  => [0,2,1,3],
    C4h => [0,2,1,3,4,5,6,7],
    D4  => [0,2,1,1,3,4,3,4],
    C4v => [0,2,1,1,3,3,4,4],
    D2d => [0,2,1,1,3,3,4,4],                                                                                         #
    Vc  => [0,2,1,1,3,3,4,4],                                                                                         #
    D4h => [0,1,1,2,3,3,4,4,5,6,6,7,8,8,9,9],
    C3  => [0,1,2],
    S6  => [0,1,2,3,4,5],                                                                                             #
    C3i => [0,1,2,3,4,5],                                                                                             #
    D3  => [0,1,1,2,2,2],
    C3v => [0,1,1,2,2,2],
    D3d => [0,3,1,4,1,4,2,5,2,5,2,5],
    C6  => [0,1,2,3,4,5],
    S3  => [0,1,2,3,4,5],                                                                                             #
    C3h => [0,1,2,3,4,5],                                                                                             #
    C6h => [0,1,2,3,4,5,6,7,8,9,10,11],
    D6  => [0,3,2,2,1,1,4,5,4,5,4,5],
    C6v => [0,3,2,2,1,1,4,4,4,5,5,5],
    D3h => [0,3,1,1,4,4,2,2,2,5,5,5],
    D6h => [0,3,2,2,1,1,5,4,5,4,5,4,6,8,8,7,7,9,10,10,10,11,11,11],
    T   => [0,1,1,1,2,3,2,3,2,3,2,3],
    Th  => [0,3,3,3,4,7,7,7,1,2,1,2,2,1,2,1,6,5,6,5,5,6,5,6],
#   O   => [5,  24, "E", "8C3", "3C2", "6C2p", "6C4"],                                            # 30     432
#   O   => [ ["E", [0,0]], ["C2x",[pi,pi]], ["C2y", [0,pi]],  ["C2z", [pi,0]],                # 30     432
#            ["C3(1)", [pi/2,pi/2]],  ["C3(2)", [pi/2,pi/2],[3*pi/2,pi/2]],  ["C3(3)", [3*pi/2,3*pi/2]],  ["C3(4)", [pi/2,pi/2],[pi/2,pi/2]],
#            ["C3^2(1)",[pi/2,pi/2],[pi/2,3*pi/2]],["C3^2(2)",[pi/2,3*pi/2]],["C3^2(3)",[pi/2,pi/2],[3*pi/2,3*pi/2]],["C3^2(4)",[3*pi/2,pi/2]],
#            ["C2d(1)",[pi/-2,0],[0,pi/-4],[pi,0],[pi/2,pi/4]], ["C2d(2)",[0,pi/-4],[pi,0],[0,pi/4]], ["C2d(3)",[pi/-4,0],[0,pi],[pi/4,0]],
#            ["C2d(4)",[pi/-2,0],[0,pi/4],[pi,0],[pi/2,pi/-4]], ["C2d(5)",[0,pi/4],[pi,0],[0,pi/-4]], ["C2d(6)",[pi/4,0],[0,pi],[pi/-4,0]],
#            ["C4x", [pi/-2,0],[0,pi/2],[pi/2,0]],    ["C4y", [0,pi/2]],   ["C4z",[pi/2,0]], 
#            ["C4x^3",[pi/-2,0],[0,3*pi/2],[pi/2,0]], ["C4y^3",[0,3*pi/2]],["C4z^3",[3*pi/2,0]] ], 
    O   => [0,2,2,2,1,1,1,1,1,1,1,1,3,3,3,3,3,3,4,4,4,4,4,4],
    Td  => [0,2,2,2,1,1,1,1,1,1,1,1,4,4,4,4,4,4,3,3,3,3,3,3],
    Oh  => [0,4,4,4,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,5,8,8,8,7,7,7,7,7,7,7,7,9,9,9,9,9,9,6,6,6,6,6,6]
);

# Stores the Character table (and IRREPS) of the point groups as a hash of hashes of arrays.
$e1 = cplxe(1,pi/3); $e1s = cplxe(1,-1*pi/3); $e2 = cplxe(1,2*pi/3); $e2s = cplxe(1,-2*pi/3); $j=Math::Complex->make(0,1);
%chartab = (
    C1  => { A  => [1] },                                                                                                                      # 1        1
    Ci  => { Ag => [1, 1], Au => [1, -1] },                                                                                                    # 2       -1
    S2  => { Ag => [1, 1], Au => [1, -1] },                                                                                                    # 2*      -1
    C2  => { A  => [1, 1], B  => [1, -1] },                                                                                                    # 3        2
    Cs  => { Ap => [1, 1], App =>[1, -1] },                                                                                                    # 4        m
    C1h => { Ap => [1, 1], App =>[1, -1] },                                                                                                    # 4*       m
    C2h => { Ag => [1, 1, 1, 1], Bg => [1,-1, 1,-1], Au => [1, 1,-1,-1], Bu => [1,-1,-1, 1] },                                                 # 5      2/m
    D2  => { A  => [1, 1, 1, 1], B1 => [1, 1,-1,-1], B2 => [1,-1, 1,-1], B3 => [1,-1,-1, 1] },                                                 # 6      222
    V   => { A  => [1, 1, 1, 1], B1 => [1, 1,-1,-1], B2 => [1,-1, 1,-1], B3 => [1,-1,-1, 1] },                                                 # 6*     222
    C2v => { A1 => [1, 1, 1, 1], A2 => [1, 1,-1,-1], B1 => [1,-1, 1,-1], B2 => [1,-1,-1, 1] },                                                 # 7      mm2
    D2h => { Ag=>[1,1,1,1,1,1,1,1],     B1g=>[1,1,-1,-1,1,1,-1,-1], B2g=>[1,-1,1,-1,1,-1,1,-1], B3g=>[1,-1,-1,1,1,-1,-1,1],                    # 8      mmm
             Au=>[1,1,1,1,-1,-1,-1,-1], B1u=>[1,1,-1,-1,-1,-1,1,1], B2u=>[1,-1,1,-1,-1,1,-1,1], B3u=>[1,-1,-1,1,-1,1,1,-1] },
    Vh  => { Ag=>[1,1,1,1,1,1,1,1],     B1g=>[1,1,-1,-1,1,1,-1,-1], B2g=>[1,-1,1,-1,1,-1,1,-1], B3g=>[1,-1,-1,1,1,-1,-1,1],                    # 8*     mmm
             Au=>[1,1,1,1,-1,-1,-1,-1], B1u=>[1,1,-1,-1,-1,-1,1,1], B2u=>[1,-1,1,-1,-1,1,-1,1], B3u=>[1,-1,-1,1,-1,1,1,-1] },
    C4  => { A  => [1, 1, 1, 1], B  => [1,-1, 1,-1], E  => [1, $j, -1, -$j] },                                                                 # 9        4
    S4  => { A  => [1, 1, 1, 1], B  => [1,-1, 1,-1], E  => [1, $j, -1, -$j] },                                                                 # 10      -4
    C4h => { Ag => [1, 1, 1, 1, 1, 1, 1, 1], Bg => [1,-1, 1,-1, 1,-1, 1,-1], Eg => [1, $j,-1,-$j, 1, $j,-1,-$j],                               # 11     4/m
             Au => [1, 1, 1, 1,-1,-1,-1,-1], Bu => [1,-1, 1,-1,-1, 1,-1, 1], Eu => [1, $j,-1,-$j,-1,-$j, 1, $j] },
    D4  => { A1 => [1, 1, 1, 1, 1], A2 => [1, 1, 1,-1,-1], B1 => [1,-1, 1, 1,-1], B2 => [1,-1, 1,-1, 1], E=>[2,0,-2,0,0] },                    # 12     422
    C4v => { A1 => [1, 1, 1, 1, 1], A2 => [1, 1, 1,-1,-1], B1 => [1,-1, 1, 1,-1], B2 => [1,-1, 1,-1, 1], E=>[2,0,-2,0,0] },                    # 13     4mm
    D2d => { A1 => [1, 1, 1, 1, 1], A2 => [1, 1, 1,-1,-1], B1 => [1,-1, 1, 1,-1], B2 => [1,-1, 1,-1, 1], E=>[2,0,-2,0,0] },                    # 14     42m
    Vc  => { A1 => [1, 1, 1, 1, 1], A2 => [1, 1, 1,-1,-1], B1 => [1,-1, 1, 1,-1], B2 => [1,-1, 1,-1, 1], E=>[2,0,-2,0,0] },                    # 14*    42m
    D4h => { A1g=> [1, 1, 1, 1, 1, 1, 1, 1, 1, 1], A2g => [1, 1, 1,-1,-1, 1, 1, 1,-1,-1], Eg => [2, 0,-2, 0, 0, 2, 0,-2, 0, 0],                # 15   4/mmm
             B1g=> [1,-1, 1, 1,-1, 1,-1, 1, 1,-1], B2g => [1,-1, 1,-1, 1, 1,-1, 1,-1, 1], Eu => [2, 0,-2, 0, 0,-2, 0, 2, 0, 0],
             A1u=> [1, 1, 1, 1, 1,-1,-1,-1,-1,-1], A2u => [1, 1,-1,-1,-1,-1,-1, 1, 1, 1], 
             B1u=> [1,-1, 1, 1,-1,-1, 1,-1,-1, 1], B2u => [1,-1, 1,-1, 1,-1, 1,-1, 1,-1] },
    C3  => { A  => [1, 1, 1], E => [1, $e2, $e2s] },                                                                                           # 16       3
    S6  => { Ag => [1,1,1,1,1,1], Eg => [1,$e2,$e2s,1,$e2,$e2s], Au => [1,1,1,-1,-1,-1], Eu => [1,$e2,$e2s,-1,-$e2,-$e2s] },                   # 17      -3
    C3i => { Ag => [1,1,1,1,1,1], Eg => [1,$e2,$e2s,1,$e2,$e2s], Au => [1,1,1,-1,-1,-1], Eu => [1,$e2,$e2s,-1,-$e2,-$e2s] },                   # 17*     -3
    D3  => { A1 => [1, 1, 1], A2 => [1, 1,-1], E => [2,-1, 0] },                                                                               # 18     321
    C3v => { A1 => [1, 1, 1], A2 => [1, 1,-1], E => [2,-1, 0] },                                                                               # 19     31m
    D3d => { A1g=>[1,1,1,1,1,1], A2g=>[1,1,-1,1,1,-1], Eg=>[2,-1,0,2,-1,0], A1u=>[1,1,1,-1,-1,-1], A2u=>[1,1,-1,-1,-1,1], Eu=>[2,-1,0,-2,1,0]},# 20    -31m
#   C6  => { A  => [1, 1, 1, 1, 1, 1], B => [1,-1, 1,-1, 1,-1], E1 => [1,$e2,$e2s,1,$e2,$e2s], E2 => [1,-$e2s,$e2,-1,$e2s,-$e2] },             # 21       6
    C6  => { A  => [1, 1, 1, 1, 1, 1], B => [1,-1, 1,-1, 1,-1], E1 => [1,$e1,-$e1s,-1,-$e1,$e1s], E2 => [1,-$e1s,-$e1,1,-$e1s,-$e1] },         # 21       6
    C3h => { Ap => [1, 1, 1, 1, 1, 1], Ep=> [1,$e2,$e2s,1,$e2,$e2s],App=> [1, 1, 1,-1,-1,-1], Epp => [1,$e2,$e2s,-1,-$e2,-$e2s] },             # 22      -6
    S3  => { Ap => [1, 1, 1, 1, 1, 1], Ep=> [1,$e2,$e2s,1,$e2,$e2s],App=> [1, 1, 1,-1,-1,-1], Epp => [1,$e2,$e2s,-1,-$e2,-$e2s] },             # 22*     -6
#   C6h => { Ag=>[1,1,1,1,1,1,1,1,1,1,1,1],       Bg=>[1,-1,1,-1,1,-1,1,-1,1,-1,1,-1], E1g=>[1,$e2,$e2s,1,$e2,$e2s,1,$e2,$e2s,1,$e2,$e2s],   #23     6/m
#            E2g=>[1,-$e2s,$e2,-1,$e2s,-$e2,1,-$e2s,$e2,-1,$e2s,-$e2],
#            Au=>[1,1,1,1,1,1,-1,-1,-1,-1,-1,-1], Bu=>[1,-1,1,-1,1,-1,-1,1,-1,1,-1,1], E1u=>[1,$e2,$e2s,1,$e2,$e2s,-1,$e2s,$e2,-1,$e2s,$e2],
#            E2u=>[1,-$e2s,$e2,-1,-$e2s,$e2,-1,$e2,-$e2s,1,$e2,-$e2s] },
#   C6h => { Ag=>[1,1,1,1,1,1,1,1,1,1,1,1],       Bg=>[1,-1,1,-1,1,-1,1,-1,1,-1,1,-1], E1g=>[1,$e1,$e2,-1,$e2s,$e1s,1,$e1,$e2,-1,$e2s,$e1s],   #23     6/m
#            E2g=>[1,$e2,$e2s,1,$e2,$e2s,1,$e2,$e2s,1,$e2,$e2s],
#            Au=>[1,1,1,1,1,1,-1,-1,-1,-1,-1,-1], Bu=>[1,-1,1,-1,1,-1,-1,1,-1,1,-1,1], E1u=>[1,$e1,$e2,-1,$e2s,$e1s,-1,$e1s,$e2s,1,$e2,$e1],
#            E2u=>[1,$e2,$e2s,1,$e2,$e2s,-1,$e2s,$e2,-1,$e2s,$e2] },
    C6h => { Ag=>[1,1,1,1,1,1,1,1,1,1,1,1],       Bg=>[1,-1,1,-1,1,-1,1,-1,1,-1,1,-1], E1g=>[1,$e1,-$e1s,-1,-$e1,$e1s,1,$e1,-$e1s,-1,-$e1,$e1s],#23     6/m
             E2g=>[1,-$e1s,-$e1,1,-$e1s,-$e1,1,-$e1s,-$e1,1,-$e1s,-$e1],
             Au=>[1,1,1,1,1,1,-1,-1,-1,-1,-1,-1], Bu=>[1,-1,1,-1,1,-1,-1,1,-1,1,-1,1], E1u=>[1,$e1,-$e1s,-1,-$e1,$e1s,-1,-$e1,$e1s,1,$e1,-$e1s],
             E2u=>[1,-$e1s,-$e1,1,-$e1s,-$e1,-1,$e1s,$e1,-1,$e1s,$e1] },
    D6  => { A1=>[1,1,1,1,1,1], A2=>[1,1,1,1,-1,-1], B1=>[1,-1,1,-1,1,-1], B2=>[1,-1,1,-1,-1,1], E1=>[2,1,-1,-2,0,0], E2=>[2,-1,-1,2,0,0] },   # 24     622
    C6v => { A1=>[1,1,1,1,1,1], A2=>[1,1,1,1,-1,-1], B1=>[1,-1,1,-1,1,-1], B2=>[1,-1,1,-1,-1,1], E1=>[2,1,-1,-2,0,0], E2=>[2,-1,-1,2,0,0] },   # 25     6mm
    D3h => {Ap1=>[1,1,1,1,1,1], Ap2=>[1,1,-1,1,1,-1],Ep=>[2,-1,0,2,-1,0], App1=>[1,1,1,-1,-1,-1], App2=>[1,1,-1,-1,-1,1],Epp=>[2,-1,0,-2,1,0]},# 26     62m
    D6h => { A1g=>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], A2g=>[1, 1, 1, 1,-1,-1, 1, 1, 1, 1,-1,-1], B1g=>[1,-1, 1,-1, 1,-1, 1,-1, 1,-1, 1,-1],  # 27   6/mmm
             B2g=>[1,-1, 1,-1,-1, 1, 1,-1, 1,-1,-1, 1], E1g=>[2, 1,-1,-2, 0, 0, 2, 1,-1,-2, 0, 0], E2g=>[2,-1,-1, 2, 0, 0, 2,-1,-1, 2, 0, 0],
             A1u=>[1, 1, 1, 1, 1, 1,-1,-1,-1,-1,-1,-1], A2u=>[1, 1, 1, 1,-1,-1,-1,-1,-1,-1, 1, 1], B1u=>[1,-1, 1,-1, 1,-1,-1, 1,-1, 1,-1, 1],
             B2u=>[1,-1, 1,-1,-1, 1,-1, 1,-1, 1, 1,-1], E1u=>[2, 1,-1,-2, 0, 0,-2,-1, 1, 2, 0, 0], E2u=>[2,-1,-1, 2, 0, 0,-2, 1, 1,-2, 0, 0] },
    T   => { A  => [1, 1, 1, 1], E => [1, 1, $e2, $e2s], T => [3,-1, 0, 0] },                                                                  # 28      23
    Th  => { Ag => [1, 1, 1, 1, 1, 1, 1, 1], Eg=>[1,$e2,$e2s,1, 1, $e2, $e2s, 1], Tg=>[3, 0, 0, -1, 3, 0, 0,-1],                               # 29      m3
             Au => [1, 1, 1, 1,-1,-1,-1,-1], Eu=>[1,$e2,$e2s,1,-1,-$e2,-$e2s,-1], Tu=>[3, 0, 0, -1,-3, 0, 0, 1] },
    O   => { A1 => [1,1,1,1,1], A2 => [1,1,1,-1,-1], E => [2,-1,2,0,0], T1 => [3,0,-1,1,-1], T2 => [3,0,-1,-1,1] },                            # 30     432
    Td  => { A1 => [1,1,1,1,1], A2 => [1,1,1,-1,-1], E => [2,-1,2,0,0], T1 => [3,0,-1,1,-1], T2 => [3,0,-1,-1,1] },                            # 31     43m
    Oh  => { A1g=>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1], A2g=>[1, 1,-1,-1, 1, 1,-1, 1, 1,-1], Eg=>[2,-1, 0, 0, 2, 2, 0,-1, 2, 0],                     # 32     m3m
             T1g=>[3, 0,-1, 1,-1, 3, 1, 0,-1,-1], T2g=>[3, 0, 1,-1,-1, 3,-1, 0,-1, 1],
             A1u=>[1, 1, 1, 1, 1,-1,-1,-1,-1,-1], A2u=>[1, 1,-1,-1, 1,-1, 1,-1,-1, 1], Eu=>[2,-1, 0, 0, 2,-2, 0, 1,-2, 0],
             T1u=>[3, 0,-1, 1,-1,-3,-1, 0, 1, 1], T2u=>[3, 0, 1,-1,-1,-3, 1, 0, 1,-1] }
);

# Converts Hermann-Mauguin symbols to Schoenflies symbols
sub hm2schoenflies {
  return unless defined wantarray;
  $hmsym=@_[0];
  switch ($hmsym) {
    case /m.*3m/    { return "Oh";  }  # m-3m 
    case /43m/      { return "Td";  }  # -43m
    case /432/      { return "O";   }  # 432
    case /m.*3/     { return "Th";  }  # m-3
    case /23/       { return "T";   }  # 23
    case /6.*mmm/   { return "D6h"; }  # 6/mmm
    case /6mm/      { return "C6v"; }  # 6mm
    case /6.*[m2]+/ { return "D3h"; }  # -62m or -6m2
    case /622/      { return "D6";  }  # 622
    case /6.*m/     { return "C6h"; }  # 6/m
    case /-6/       { return "C3h"; }  # -6
    case /6/        { return "C6";  }  # 6
    case /-3[m1]+/  { return "D3d"; }  # -3m1 or -31m
    case /3[m1]+/   { return "C3v"; }  # 3m1  or 31m
    case /3[12]+/   { return "D3";  }  # 321  or 312
    case /-3/       { return "C3i"; }  # -3
    case /3/        { return "C3";  }  # 3
    case /4.*mmm/   { return "D4h"; }  # 4/mmm
    case /4mm/      { return "C4v"; }  # 4mm
    case /422/      { return "D4";  }  # 422
    case /4[m2][m2]/{ return "D2d"; }  # -42m or -4m2
    case /4.*m/     { return "C4h"; }  # 4/m
    case /-4/       { return "S4";  }  # -4
    case /4/        { return "C4";  }  # 4
    case /mmm/      { return "D2h"; }  # mmm
    case /mm/       { return "C2v"; }  # mm2
    case /222/      { return "D2";  }  # 222
    case /2.*m/     { return "C2h"; }  # 2/m
    case /m/        { return "Cs";  }  # m
    case /2/        { return "C2";  }  # 2
    case /-1/       { return "Ci";  }  # -1
    case /1/        { return "C1";  }  # 1
    else            { print "Sorry Hermann-Mauguin symbol not recognised\n"; return; }
  }
}
